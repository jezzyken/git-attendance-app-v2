"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[147],{1433:function(t,e,s){s.r(e),s.d(e,{default:function(){return D}});var i=s(3740),a=s(3698),n=s(2938),r=s(3180),o=s(4414),l=s(3449),c=s(6814),u=s(9483),h=s(6930),d=s(8983),m=s(7296),f=s(2239),p=s(4437),g=s(2756),v=s(5834),b=s(1034),y=s(7270),S=function(){var t=this,e=t._self._c;return e(l.A,{attrs:{fluid:""}},[e(n.ri,{staticClass:"d-flex align-center py-4"},[e(h.A,{staticClass:"mr-3",attrs:{large:"",color:"primary"}},[t._v("mdi-account-school")]),e("span",{staticClass:"text-h5"},[t._v("Class Schedule Report")])],1),e(a.A,{staticClass:"my-4",attrs:{elevation:"2"}},[e(n.OQ,[e(g.A,[e(o.A,{attrs:{cols:"12",sm:"6",md:"4"}},[e(v.A,{attrs:{items:t.courses,"item-text":"courseName","item-value":"_id",label:"Select Course",clearable:"",outlined:"",dense:""},on:{change:t.handleCourseChange},model:{value:t.filters.course,callback:function(e){t.$set(t.filters,"course",e)},expression:"filters.course"}})],1),e(o.A,{attrs:{cols:"12",sm:"6",md:"4"}},[e(v.A,{attrs:{items:t.filteredSubjects,"item-text":"subjectName","item-value":"_id",label:"Select Subject",clearable:"",outlined:"",dense:"",disabled:!t.filters.course},on:{change:t.handleSubjectChange},model:{value:t.filters.subject,callback:function(e){t.$set(t.filters,"subject",e)},expression:"filters.subject"}})],1),e(o.A,{attrs:{cols:"12",sm:"6",md:"4"}},[e(v.A,{attrs:{items:t.teachers,"item-text":"user.lastName","item-value":"_id",label:"Select Teacher",clearable:"",outlined:"",dense:""},scopedSlots:t._u([{key:"selection",fn:function({item:e}){return[t._v(" "+t._s(t.getTeacherName(e))+" ")]}},{key:"item",fn:function({item:e}){return[t._v(" "+t._s(t.getTeacherName(e))+" ")]}}]),model:{value:t.filters.teacher,callback:function(e){t.$set(t.filters,"teacher",e)},expression:"filters.teacher"}})],1),e(o.A,{attrs:{cols:"12",sm:"6",md:"4"}},[e(v.A,{attrs:{items:t.weekDays,label:"Select Day",clearable:"",outlined:"",dense:""},model:{value:t.filters.weekDay,callback:function(e){t.$set(t.filters,"weekDay",e)},expression:"filters.weekDay"}})],1),e(o.A,{attrs:{cols:"12",sm:"6",md:"4"}},[e(v.A,{attrs:{items:t.timeSlots,"item-text":"text","item-value":"value",label:"Start Time",clearable:"",outlined:"",dense:""},model:{value:t.filters.startTime,callback:function(e){t.$set(t.filters,"startTime",e)},expression:"filters.startTime"}})],1),e(o.A,{attrs:{cols:"12",sm:"6",md:"4"}},[e(v.A,{attrs:{items:t.timeSlots,"item-text":"text","item-value":"value",label:"End Time",clearable:"",outlined:"",dense:""},model:{value:t.filters.endTime,callback:function(e){t.$set(t.filters,"endTime",e)},expression:"filters.endTime"}})],1)],1),e(g.A,[e(o.A,{staticClass:"d-flex justify-end",attrs:{cols:"12"}},[e(i.A,{staticClass:"mr-2",attrs:{color:"#d2691e",loading:t.loading,dark:""},on:{click:t.applyFilters}},[t._v(" Apply Filters ")]),e(i.A,{attrs:{color:"secondary",text:"",disabled:t.loading},on:{click:t.resetFilters}},[t._v(" Reset ")])],1)],1)],1),e(c.A,{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.scheduleReports,loading:t.loading,"show-expand":"","single-expand":"","item-key":"_id"},scopedSlots:t._u([{key:"item.course",fn:function({item:e}){return[t._v(" "+t._s(e.course?.courseName)+" ")]}},{key:"item.subject",fn:function({item:e}){return[t._v(" "+t._s(e.subject?.subjectName)+" ")]}},{key:"item.teacher",fn:function({item:e}){return[t._v(" "+t._s(t.getTeacherName(e.teacher))+" ")]}},{key:"item.weekDays",fn:function({item:s}){return t._l(s.weekDays,(function(s){return e(r.A,{key:s,staticClass:"mr-1",attrs:{small:"",color:"#f4a460",dark:""}},[t._v(" "+t._s(s)+" ")])}))}},{key:"item.time",fn:function({item:e}){return[t._v(" "+t._s(t.formatTime(e.startTime))+" - "+t._s(t.formatTime(e.endTime))+" ")]}},{key:"item.students",fn:function({item:e}){return[t._v(" "+t._s(e.students?.length||0)+" students ")]}},{key:"expanded-item",fn:function({headers:s,item:o}){return[e("td",{staticClass:"pa-0",attrs:{colspan:s.length}},[e(a.A,{attrs:{flat:""}},[e(n.ri,{staticClass:"subtitle-1 d-flex align-center"},[t._v(" Students List "),e(r.A,{staticClass:"ml-2",attrs:{small:""}},[t._v(" "+t._s(o.students?.length||0)+" students ")]),e(b.A),e(y.A,{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:s,attrs:a}){return[e(i.A,t._g(t._b({staticClass:"ml-2",attrs:{color:"primary",text:""},on:{click:function(e){return e.stopPropagation(),t.downloadStudentListPDF(o)}}},"v-btn",a,!1),s),[e(h.A,{attrs:{left:""}},[t._v("mdi-file-pdf-box")]),t._v(" PDF ")],1)]}}],null,!0)},[e("span",[t._v("Download PDF")])]),e(y.A,{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:s,attrs:a}){return[e(i.A,t._g(t._b({staticClass:"ml-2",attrs:{color:"success",text:""},on:{click:function(e){return e.stopPropagation(),t.downloadStudentListCSV(o)}}},"v-btn",a,!1),s),[e(h.A,{attrs:{left:""}},[t._v("mdi-file-excel")]),t._v(" CSV ")],1)]}}],null,!0)},[e("span",[t._v("Download CSV")])])],1),e(u.A),o.students?.length?e(d.A,{attrs:{dense:""}},t._l(o.students,(function(s){return e(m.A,{key:s._id},[e(f.A,[e(h.A,[t._v("mdi-account-circle")])],1),e(p.pr,[e(p.UZ,[t._v(" "+t._s(t.getStudentName(s))+" ")]),e(p.w,[t._v(" Student ID: "+t._s(s.studentId)+" ")])],1)],1)})),1):e(n.OQ,{staticClass:"text-center text-subtitle-1 grey--text"},[t._v(" No students enrolled in this schedule ")])],1)],1)]}}])})],1)],1)},A=[],x=(s(4114),s(4603),s(7566),s(8721),s(5353)),w=s(5093),T=s.n(w),_=s(4323),C=(s(3246),{name:"ReportView",data:()=>({headers:[{text:"Course",value:"course"},{text:"Subject",value:"subject"},{text:"Section",value:"section"},{text:"Teacher",value:"teacher"},{text:"Days",value:"weekDays"},{text:"Time",value:"time"},{text:"Students",value:"students"},{text:"",value:"data-table-expand"}],weekDays:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],timeSlots:[],filters:{course:null,subject:null,teacher:null,weekDay:null,startTime:null,endTime:null},downloading:!1,expandedRow:null}),computed:{...(0,x.aH)({courses:t=>t.courses.courses,subjects:t=>t.subjects.subjects,teachers:t=>t.teachers.teachers,loading:t=>t.reports.loading,scheduleReports:t=>t.reports.scheduleReports.data}),filteredSubjects(){return this.filters.course?this.subjects.filter((t=>t.course&&t.course.some((t=>t._id===this.filters.course)))):[]}},methods:{...(0,x.i0)({fetchReports:"reports/fetchScheduleReports",fetchCourses:"courses/fetchCourses",fetchSubjects:"subjects/fetchSubjects",fetchTeachers:"teachers/fetchTeachers",updateFilters:"reports/updateFilters"}),generateTimeSlots(){const t=[],e=T()("07:00","HH:mm"),s=T()("18:00","HH:mm");while(e<=s)t.push({value:e.format("HH:mm"),text:e.format("h:mm A")}),e.add(30,"minutes");return t},formatTime(t){return T()(t,"HH:mm").format("h:mm A")},getTeacherName(t){if(!t?.user)return"";const{firstName:e,lastName:s,middleName:i}=t.user;return`${s}, ${e} ${i||""}`.trim()},getStudentName(t){if(!t?.user)return"";const{firstName:e,lastName:s,middleName:i}=t.user;return`${s}, ${e} ${i||""}`.trim()},handleCourseChange(){this.filters.subject=null},handleSubjectChange(){console.log("subject")},async applyFilters(){await this.updateFilters(this.filters)},async resetFilters(){this.filters={course:null,subject:null,teacher:null,weekDay:null,startTime:null,endTime:null},await this.fetchReports()},async downloadStudentListPDF(t){try{this.downloading=!0;const e=new _["default"]({orientation:"portrait",unit:"in",format:"a4"}),s=[165,42,42],i=[249,235,235],a=.5,n=e.internal.pageSize.getWidth(),r=n-2*a;e.setFontSize(16),e.setTextColor(s[0],s[1],s[2]);const o="Student List",l=16*e.getStringUnitWidth(o)/e.internal.scaleFactor,c=(n-l)/2;e.text(o,c,a+.3),e.setFontSize(10),e.setTextColor(0,0,0);const u=[`Course: ${t.course?.courseName||"N/A"}`,`Subject: ${t.subject?.subjectName||"N/A"}`,`Teacher: ${this.getTeacherName(t.teacher)}`,`Schedule: ${t.weekDays.join(", ")} | ${this.formatTime(t.startTime)} - ${this.formatTime(t.endTime)}`];u.forEach(((t,s)=>{e.text(t,a,a+.6+.2*s)}));const h=t.students?.map(((t,e)=>[(e+1).toString(),t.studentId||"N/A",this.getStudentName(t)]))||[];e.autoTable({startY:a+1.5,head:[["No.","Student ID","Student Name"]],body:h,styles:{fontSize:9,cellPadding:.05,halign:"left"},headStyles:{fillColor:s,textColor:255,fontSize:10,fontStyle:"bold",halign:"center"},alternateRowStyles:{fillColor:i},columnStyles:{0:{cellWidth:.1*r},1:{cellWidth:.3*r},2:{cellWidth:.6*r}},margin:{left:a,right:a,top:a,bottom:a},tableWidth:r});const d=e.internal.getNumberOfPages();for(let t=1;t<=d;t++){e.setPage(t),e.setFontSize(8),e.setTextColor(s[0],s[1],s[2]);const i=T()().format("MM/DD/YYYY HH:mm:ss");e.text(`Generated on: ${i}`,a,e.internal.pageSize.height-a),e.text(`Page ${t} of ${d}`,e.internal.pageSize.width-a-1,e.internal.pageSize.height-a)}const m=`student-list-${t.course?.courseName}-${t.subject?.subjectName}-${T()().format("YYYY-MM-DD_HH-mm")}`.toLowerCase().replace(/\s+/g,"-");e.save(`${m}.pdf`)}catch(e){console.error("Error generating PDF:",e)}finally{this.downloading=!1}},async downloadStudentListCSV(t){try{this.downloading=!0;const e=[["Course",t.course?.courseName||"N/A"],["Subject",t.subject?.subjectName||"N/A"],["Teacher",this.getTeacherName(t.teacher)],["Schedule",`${t.weekDays.join(", ")} | ${this.formatTime(t.startTime)} - ${this.formatTime(t.endTime)}`],[],["No.","Student ID","Student Name"]],s=t.students?.map(((t,e)=>[e+1,t.studentId||"N/A",this.getStudentName(t)]))||[],i=[...e,...s].map((t=>t.map((t=>`"${t}"`)).join(","))).join("\n"),a=`student-list-${t.course?.courseName}-${t.subject?.subjectName}`.toLowerCase().replace(/\s+/g,"-"),n=new Blob([i],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),o=URL.createObjectURL(n);r.setAttribute("href",o),r.setAttribute("download",`${a}.csv`),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(o)}catch(e){downloading,console.error("Error generating CSV:",e)}finally{this.downloading=!1}},expandRow(t){this.expandedRow=[t]},collapseAll(){this.expandedRow=[]},async initialize(){this.timeSlots=this.generateTimeSlots();try{await Promise.all([this.fetchCourses(),this.fetchSubjects(),this.fetchTeachers(),this.fetchReports()])}catch(t){console.error("Failed to initialize report view:",t)}}},created(){this.initialize()}}),k=C,j=s(1656),N=(0,j.A)(k,S,A,!1,null,"69539a6d",null),D=N.exports},7270:function(t,e,s){s.d(e,{A:function(){return h}});var i=s(5030),a=s(8743),n=s(7391),r=s(2031),o=s(9975),l=s(4152),c=s(6988),u=s(5803),h=(0,u.A)(a.A,n.A,r.A,o.A).extend({name:"v-tooltip",props:{closeDelay:{type:[Number,String],default:0},disabled:Boolean,openDelay:{type:[Number,String],default:0},openOnHover:{type:Boolean,default:!0},openOnFocus:{type:Boolean,default:!0},tag:{type:String,default:"span"},transition:String},data:()=>({calculatedMinWidth:0,closeDependents:!1}),computed:{calculatedLeft(){const{activator:t,content:e}=this.dimensions,s=!this.bottom&&!this.left&&!this.top&&!this.right,i=!1!==this.attach?t.offsetLeft:t.left;let a=0;return this.top||this.bottom||s?a=i+t.width/2-e.width/2:(this.left||this.right)&&(a=i+(this.right?t.width:-e.width)+(this.right?10:-10)),this.nudgeLeft&&(a-=parseInt(this.nudgeLeft)),this.nudgeRight&&(a+=parseInt(this.nudgeRight)),`${this.calcXOverflow(a,this.dimensions.content.width)}px`},calculatedTop(){const{activator:t,content:e}=this.dimensions,s=!1!==this.attach?t.offsetTop:t.top;let i=0;return this.top||this.bottom?i=s+(this.bottom?t.height:-e.height)+(this.bottom?10:-10):(this.left||this.right)&&(i=s+t.height/2-e.height/2),this.nudgeTop&&(i-=parseInt(this.nudgeTop)),this.nudgeBottom&&(i+=parseInt(this.nudgeBottom)),!1===this.attach&&(i+=this.pageYOffset),`${this.calcYOverflow(i)}px`},classes(){return{"v-tooltip--top":this.top,"v-tooltip--right":this.right,"v-tooltip--bottom":this.bottom,"v-tooltip--left":this.left,"v-tooltip--attached":""===this.attach||!0===this.attach||"attach"===this.attach}},computedTransition(){return this.transition?this.transition:this.isActive?"scale-transition":"fade-transition"},offsetY(){return this.top||this.bottom},offsetX(){return this.left||this.right},styles(){return{left:this.calculatedLeft,maxWidth:(0,l.Dg)(this.maxWidth),minWidth:(0,l.Dg)(this.minWidth),top:this.calculatedTop,zIndex:this.zIndex||this.activeZIndex}}},beforeMount(){this.$nextTick((()=>{this.value&&this.callActivate()}))},mounted(){"v-slot"===(0,l.fo)(this,"activator",!0)&&(0,c.yA)("v-tooltip's activator slot must be bound, try '<template #activator=\"data\"><v-btn v-on=\"data.on>'",this)},methods:{activate(){this.updateDimensions(),requestAnimationFrame(this.startTransition)},deactivate(){this.runDelay("close")},genActivatorListeners(){const t=i.A.options.methods.genActivatorListeners.call(this);return this.openOnFocus&&(t.focus=t=>{this.getActivator(t),this.runDelay("open")},t.blur=t=>{this.getActivator(t),this.runDelay("close")}),t.keydown=t=>{t.keyCode===l.uP.esc&&(this.getActivator(t),this.runDelay("close"))},t},genActivatorAttributes(){return{"aria-haspopup":!0,"aria-expanded":String(this.isActive)}},genTransition(){const t=this.genContent();return this.computedTransition?this.$createElement("transition",{props:{name:this.computedTransition}},[t]):t},genContent(){return this.$createElement("div",this.setBackgroundColor(this.color,{staticClass:"v-tooltip__content",class:{[this.contentClass]:!0,menuable__content__active:this.isActive,"v-tooltip__content--fixed":this.activatorFixed},style:this.styles,attrs:this.getScopeIdAttrs(),directives:[{name:"show",value:this.isContentActive}],ref:"content"}),this.getContentSlot())}},render(t){return t(this.tag,{staticClass:"v-tooltip",class:this.classes},[this.showLazyContent((()=>[this.genTransition()])),this.genActivator()])}})},6955:function(t,e,s){var i=s(2140),a=s(4901),n=s(2195),r=s(8227),o=r("toStringTag"),l=Object,c="Arguments"===n(function(){return arguments}()),u=function(t,e){try{return t[e]}catch(s){}};t.exports=i?n:function(t){var e,s,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(s=u(e=l(t),o))?s:c?n(e):"Object"===(i=n(e))&&a(e.callee)?"Arguments":i}},2106:function(t,e,s){var i=s(283),a=s(4913);t.exports=function(t,e,s){return s.get&&i(s.get,e,{getter:!0}),s.set&&i(s.set,e,{setter:!0}),a.f(t,e,s)}},2140:function(t,e,s){var i=s(8227),a=i("toStringTag"),n={};n[a]="z",t.exports="[object z]"===String(n)},655:function(t,e,s){var i=s(6955),a=String;t.exports=function(t){if("Symbol"===i(t))throw new TypeError("Cannot convert a Symbol value to a string");return a(t)}},2812:function(t){var e=TypeError;t.exports=function(t,s){if(t<s)throw new e("Not enough arguments");return t}},4603:function(t,e,s){var i=s(6840),a=s(9504),n=s(655),r=s(2812),o=URLSearchParams,l=o.prototype,c=a(l.append),u=a(l["delete"]),h=a(l.forEach),d=a([].push),m=new o("a=1&a=2&b=3");m["delete"]("a",1),m["delete"]("b",void 0),m+""!=="a=2"&&i(l,"delete",(function(t){var e=arguments.length,s=e<2?void 0:arguments[1];if(e&&void 0===s)return u(this,t);var i=[];h(this,(function(t,e){d(i,{key:e,value:t})})),r(e,1);var a,o=n(t),l=n(s),m=0,f=0,p=!1,g=i.length;while(m<g)a=i[m++],p||a.key===o?(p=!0,u(this,a.key)):f++;while(f<g)a=i[f++],a.key===o&&a.value===l||c(this,a.key,a.value)}),{enumerable:!0,unsafe:!0})},7566:function(t,e,s){var i=s(6840),a=s(9504),n=s(655),r=s(2812),o=URLSearchParams,l=o.prototype,c=a(l.getAll),u=a(l.has),h=new o("a=1");!h.has("a",2)&&h.has("a",void 0)||i(l,"has",(function(t){var e=arguments.length,s=e<2?void 0:arguments[1];if(e&&void 0===s)return u(this,t);var i=c(this,t);r(e,1);var a=n(s),o=0;while(o<i.length)if(i[o++]===a)return!0;return!1}),{enumerable:!0,unsafe:!0})},8721:function(t,e,s){var i=s(3724),a=s(9504),n=s(2106),r=URLSearchParams.prototype,o=a(r.forEach);i&&!("size"in r)&&n(r,"size",{get:function(){var t=0;return o(this,(function(){t++})),t},configurable:!0,enumerable:!0})}}]);
//# sourceMappingURL=147.7a33dc9a.js.map